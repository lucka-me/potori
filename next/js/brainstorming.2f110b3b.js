(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["brainstorming"],{1923:function(t){t.exports=JSON.parse('{"en":{"title":"Brainstorming","update":"Update","updating":"Updating Brainstorming","updateInform":"Updated {count} records."},"zh":{"title":"Brainstorming","update":"更新","updating":"正在更新Brainstorming","updateInform":"更新了{count}条记录。"}}')},"2fe3":function(t){t.exports=JSON.parse('{"en":{"title":"Coverage","recorded":"Recorded","notRecorded":"Not Recorded","early":"Early Nomination"},"zh":{"title":"覆盖率","recorded":"有记录","notRecorded":"无记录","early":"早期提名"}}')},"458f":function(t,e,a){"use strict";a("be74")},"7f91":function(t){t.exports=JSON.parse('{"en":{"title":"Reviews by Month"},"zh":{"title":"每月审查次数"}}')},"83d4":function(t){t.exports=JSON.parse('{"en":{"title":"Synch","synched":"Synched","notSynched":"Not Synched"},"zh":{"title":"同步率","synched":"同步","notSynched":"不同步"}}')},"88b2":function(t,e,a){"use strict";a.r(e);var s=a("7a23");const r={key:0,class:"brainstorming"},o={key:1,class:"grid grid--1-1-1"};function n(t,e,a,n,i,c){const l=Object(s["E"])("material-icon-button"),d=Object(s["E"])("material-top-app-bar"),u=Object(s["E"])("material-top-app-bar-adjust"),h=Object(s["E"])("linear-progress"),b=Object(s["E"])("coverage-chart"),p=Object(s["E"])("rates-chart"),O=Object(s["E"])("synch-chart"),f=Object(s["E"])("reviews-by-month-chart");return Object(s["x"])(),Object(s["createElementBlock"])(s["a"],null,[Object(s["k"])(d,{title:t.$t("title"),"navi-back":""},{default:Object(s["J"])(()=>[t.canUpdate?(Object(s["x"])(),Object(s["e"])(l,{key:0,icon:"redo",title:t.$t("update"),onClick:t.update},null,8,["title","onClick"])):Object(s["f"])("",!0)]),_:1},8,["title"]),Object(s["k"])(u),t.empty?Object(s["f"])("",!0):(Object(s["x"])(),Object(s["createElementBlock"])("main",r,[t.updating?(Object(s["x"])(),Object(s["e"])(h,{key:0,text:t.$t("updating"),determinate:""},null,8,["text"])):Object(s["f"])("",!0),t.idle?(Object(s["x"])(),Object(s["createElementBlock"])("div",o,[Object(s["k"])(b),Object(s["k"])(p),Object(s["k"])(O)])):Object(s["f"])("",!0),t.idle?(Object(s["x"])(),Object(s["e"])(f,{key:2})):Object(s["f"])("",!0)]))],64)}var i=a("9ab4"),c=a("9b4a"),l=(a("cadc"),a("1b40")),d=a("42b4"),u=a("2e5e"),h=a("6022"),b=a("81dd"),p=a("2281"),O=a("4892"),f=a("d43c");function g(t,e,a,r,o,n){const i=Object(s["E"])("chart-view"),c=Object(s["E"])("chart-card");return Object(s["x"])(),Object(s["e"])(c,{title:t.title},{default:Object(s["J"])(()=>[Object(s["k"])(i,{"chart-type":"doughnut","chart-datasets":t.datasets,"chart-labels":t.labels,"chart-options":t.options},null,8,["chart-datasets","chart-labels","chart-options"])]),_:1},8,["title"])}var j,y=a("ad8e"),m=a("53ea"),v=a("84b6"),C=a("2fe3");let x=j=class extends l["d"]{constructor(){super(...arguments),this.options={plugins:{legend:{display:!0,position:"right"}}},this.datasets=[],this.rate=0}get title(){const t=this.$t("title");return 0===this.rate?t:`${t} | ${this.rate.toFixed(2)}%`}get labels(){return[this.$t("recorded"),this.$t("notRecorded"),this.$t("early")]}mounted(){this.updateData()}updateData(){return Object(i["b"])(this,void 0,void 0,(function*(){const t=yield u["a"].getAll(),e=[0,0,0],a=[];for(const r of t){if(y["a"].beforeCreate(r)){e[2]++;continue}const t=y["a"].contains(r).then(t=>{e[t?0:1]++});a.push(t)}yield Promise.allSettled(a);const s={data:e,backgroundColor:j.colors,borderAlign:"inner",borderColor:"rgba(0, 0, 0, 0.2)",hoverBackgroundColor:j.colors,hoverBorderColor:"rgba(0, 0, 0, 0.4)"};this.datasets=[s],e[0]>0||e[1]>0?this.rate=e[0]/(e[0]+e[1]+e[2])*100:this.rate=0}))}};x.colors=["royalblue","gray","orange"],x=j=Object(i["c"])([Object(l["b"])({components:{ChartCard:m["a"],ChartView:v["a"]},i18n:{messages:C}})],x);var S=x;S.render=g;var k=S;function $(t,e,a,r,o,n){const i=Object(s["E"])("chart-view"),c=Object(s["E"])("chart-card");return Object(s["x"])(),Object(s["e"])(c,{title:t.$t("title")},{default:Object(s["J"])(()=>[Object(s["k"])(i,{"chart-type":"radar","chart-datasets":t.datasets,"chart-labels":t.labels,"chart-options":t.options},null,8,["chart-datasets","chart-labels","chart-options"])]),_:1},8,["title"])}var w=a("d475");let E=class extends l["d"]{constructor(){super(...arguments),this.options={elements:{line:{tension:0}},scales:{r:{min:1,max:5,ticks:{stepSize:1}}},plugins:{legend:{display:!1}}},this.datasets=[]}get labels(){return[this.$t("quality"),this.$t("description"),this.$t("cultural"),this.$t("uniqueness"),this.$t("safety"),this.$t("location")]}mounted(){this.updateData()}updateData(){return Object(i["b"])(this,void 0,void 0,(function*(){const t=yield u["a"].getAll(),e=[];for(let n=0;n<6;++n)e.push({count:0,rate:0});const a=(t,e)=>{if(!t)return;const a=parseInt(t);isNaN(a)||(e.count++,e.rate+=a)},s=[];for(const n of t){const t=y["a"].getFromLocal(n).then(t=>{if(t)for(const[s,r]of Object.entries(t)){if(!s.startsWith("review_"))continue;const t=r;a(t.JSON.quality,e[0]),a(t.JSON.description,e[1]),a(t.JSON.cultural,e[2]),a(t.JSON.uniqueness,e[3]),a(t.JSON.safety,e[4]),a(t.JSON.location,e[5])}});s.push(t)}yield Promise.allSettled(s);const r=e.map(t=>t.rate/t.count),o={data:r,borderColor:"royalblue"};this.datasets=[o]}))}};E=Object(i["c"])([Object(l["b"])({components:{ChartCard:m["a"],ChartView:v["a"]},i18n:{messages:w}})],E);var B=E;B.render=$;var D=B;function J(t,e,a,r,o,n){const i=Object(s["E"])("chart-view"),c=Object(s["E"])("chart-card");return Object(s["x"])(),Object(s["e"])(c,{title:t.$t("title")},{default:Object(s["J"])(()=>[Object(s["k"])(i,{"chart-type":"line","chart-datasets":t.datasets,"chart-options":t.options},null,8,["chart-datasets","chart-options"])]),_:1},8,["title"])}var N=a("1315"),R=a("7f91");let M=class extends l["d"]{constructor(){super(...arguments),this.options={scales:{x:{type:"time",time:{unit:"month",tooltipFormat:"yyyy-MM",displayFormats:{month:"yyyy-MM"}}}},plugins:{legend:{display:!1},tooltip:{mode:"x"}}},this.datasets=[]}mounted(){this.updateData()}updateData(){return Object(i["b"])(this,void 0,void 0,(function*(){const t=yield u["a"].getAll(),e=new Map;if(t.length>0){let a=N["DateTime"].fromMillis(t[0].confirmedTime).startOf("month").valueOf(),s=a;const r=[];for(const o of t){const t=y["a"].getFromLocal(o).then(t=>{var r;if(t)for(const[o,n]of Object.entries(t)){if(!o.startsWith("review_"))continue;const t=n,i=N["DateTime"].fromMillis(t.Timestamp).startOf("month").valueOf();i<a?a=i:i>s&&(s=i),e.set(i,(null!==(r=e.get(i))&&void 0!==r?r:0)+1)}});r.push(t)}yield Promise.allSettled(r),Object(m["b"])(e,a,s)}const a=[];for(const[r,o]of e)a.push({x:r,y:o});a.sort((t,e)=>t.x-e.x);const s={data:a,borderColor:"royalblue",pointBackgroundColor:"royalblue",pointRadius:0,fill:!0};this.datasets=[s]}))}};M=Object(i["c"])([Object(l["b"])({components:{ChartCard:m["a"],ChartView:v["a"]},i18n:{messages:R}})],M);var q=M;q.render=J;var A=q;function I(t,e,a,r,o,n){const i=Object(s["E"])("chart-view"),c=Object(s["E"])("chart-card");return Object(s["x"])(),Object(s["e"])(c,{title:t.title},{default:Object(s["J"])(()=>[Object(s["k"])(i,{"chart-type":"doughnut","chart-datasets":t.datasets,"chart-labels":t.labels,"chart-options":t.options},null,8,["chart-datasets","chart-labels","chart-options"])]),_:1},8,["title"])}var _,F=a("ce89"),z=a("83d4");let P=_=class extends l["d"]{constructor(){super(...arguments),this.options={plugins:{legend:{display:!0,position:"right"}}},this.datasets=[],this.rate=0}get title(){const t=this.$t("title");return 0===this.rate?t:`${t} | ${this.rate.toFixed(2)}%`}get labels(){return[this.$t("synched"),this.$t("notSynched")]}mounted(){this.updateData()}updateData(){return Object(i["b"])(this,void 0,void 0,(function*(){const t=yield u["a"].getAll(),e=[0,0],a=[];for(const r of t){if(r.status===F["a"].StatusCode.Pending)continue;let t=!0,s=!1;r.status===F["a"].StatusCode.Rejected?r.reasons.includes(F["a"].Reason.duplicated)?s=!0:r.reasons.includes(F["a"].Reason.close)&&(t=!1):t=!1;const o=y["a"].getFromLocal(r).then(a=>{if(a)for(const[r,o]of Object.entries(a)){if(!r.startsWith("review_"))continue;const a=o;if("D"===a.stars){e[s?0:1]++;continue}const n=parseInt(a.stars);isNaN(n)||(n<3&&t||n>=3&&!t?e[0]++:e[1]++)}});a.push(o)}yield Promise.allSettled(a);const s={data:e,backgroundColor:_.colors,borderAlign:"inner",borderColor:"rgba(0, 0, 0, 0.2)",hoverBackgroundColor:_.colors,hoverBorderColor:"rgba(0, 0, 0, 0.4)"};this.datasets=[s],e[0]>0||e[1]>0?this.rate=e[0]/(e[0]+e[1])*100:this.rate=0}))}};P.colors=["royalblue","gray"],P=_=Object(i["c"])([Object(l["b"])({components:{ChartCard:m["a"],ChartView:v["a"]},i18n:{messages:z}})],P);var T=P;T.render=I;var U=T,L=a("1923");let V=class extends l["d"]{constructor(){super(...arguments),this.empty=!0}get saveID(){return this.$store.state.dia.saveID}get canUpdate(){return!this.empty&&this.$store.state.service.status===h["b"].Status.idle}get updating(){return this.$store.state.service.status===h["b"].Status.queryingBrainstorming}get idle(){return this.$store.state.service.status===h["b"].Status.idle}get progress(){return this.$store.state.progress.progress/this.$store.state.progress.max}created(){this.updateData(),c["e"].register(c["a"],c["j"],c["m"],c["f"],c["i"],c["n"],c["o"],c["k"],c["p"],c["g"],c["q"],c["h"]),c["e"].defaults.maintainAspectRatio=!1,c["e"].defaults.plugins.legend.labels.boxWidth=10,c["e"].defaults.plugins.tooltip.intersect=!1,c["e"].defaults.elements.line.tension=.1}onSaved(){this.updateData()}update(){return Object(i["b"])(this,void 0,void 0,(function*(){const t=yield h["b"].updateBrainstorming();d["a"].inform(this.$t("updateInform",{count:t}))}))}updateData(){return Object(i["b"])(this,void 0,void 0,(function*(){const t=yield u["a"].count();this.empty=t<1}))}};Object(i["c"])([Object(l["e"])("saveID")],V.prototype,"onSaved",null),V=Object(i["c"])([Object(l["b"])({components:{MaterialTopAppBar:p["a"],MaterialTopAppBarAdjust:O["a"],MaterialIconButton:b["a"],LinearProgress:f["a"],CoverageChart:k,RatesChart:D,SynchChart:U,ReviewsByMonthChart:A},i18n:{messages:L}})],V);var W=V;a("458f");W.render=n;e["default"]=W},be74:function(t,e,a){},d475:function(t){t.exports=JSON.parse('{"en":{"title":"Rates","quality":"Quality","description":"Description","cultural":"Cultura","uniqueness":"Uniqueness","safety":"Safety","location":"Location"},"zh":{"title":"评分","quality":"质量","description":"描述","cultural":"文化","uniqueness":"独特","safety":"安全","location":"位置"}}')}}]);
//# sourceMappingURL=brainstorming.2f110b3b.js.map